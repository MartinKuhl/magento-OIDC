<!-- 
        This template shows a SSO box on the admin backend pages
        Use this if you want to show a sso button on your backend pages
    -->
<?php

echo
    '<div class="actions" style="text-align:center;">
            <svg height="5" width="131">
                <line x1="0" y1="0" x2="127" y2="0" style="stroke:#969393;stroke-width:3" ></line>
            </svg>OR
            <svg height="5" width="133">
                <line x1="0" y1="0" x2="128" y2="0" style="stroke:#969393;stroke-width:3" ></line>
            </svg>
            <button type="button" class="action-login action-primary" style="margin-top:3%; padding: 3% 14%; width:100%; text-align:center;" onclick="window.location.href=\'' . $this->escapeUrl($this->getAdminSPInitiatedUrl(null, $this->getAppName())) . '\';">' . $this->escapeHtml($this->getSSOButtonText()) . '</button>
    </div>';

if ($this->isNonOidcAdminLoginDisabled()): ?>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Hide username field
            var usernameField = document.querySelector('.field-username');
            if (usernameField) {
                usernameField.style.display = 'none';
            }

            // Hide password field
            var passwordField = document.querySelector('.field-password');
            if (passwordField) {
                passwordField.style.display = 'none';
            }

            // Hide the welcome message and the <br/> after it
            var legend = document.querySelector('#login-form .admin__legend');
            if (legend) {
                legend.style.display = 'none';
                if (legend.nextSibling && legend.nextSibling.nodeName === 'BR') {
                    legend.nextSibling.style.display = 'none';
                }
            }

            // Hide standard Magento actions div and OR separator from OIDC div
            var actionsDivs = document.querySelectorAll('.form-actions .actions');
            actionsDivs.forEach(function (div) {
                var svgs = div.querySelectorAll('svg');
                if (svgs.length > 0) {
                    // This is our OIDC div - hide SVGs and OR text, ensure full width
                    div.style.width = '100%';
                    svgs.forEach(function (svg) {
                        svg.style.display = 'none';
                    });
                    div.childNodes.forEach(function (node) {
                        if (node.nodeType === 3 && node.textContent.trim() === 'OR') {
                            node.textContent = '';
                        }
                    });
                } else {
                    // This is Magento's standard actions div - hide entirely
                    div.style.display = 'none';
                }
            });

            // Hide the "Forgot your password?" link
            var forgotPasswordDiv = document.querySelector('#login-form .links');
            if (forgotPasswordDiv) {
                forgotPasswordDiv.style.display = 'none';
            }

            // Ensure full-width chain so the OIDC button fills the login card
            var fieldset = document.querySelector('#login-form .admin__fieldset');
            if (fieldset) {
                fieldset.style.width = '100%';
            }
            var formActions = document.querySelector('.form-actions');
            if (formActions) {
                formActions.style.width = '100%';
                formActions.style.marginTop = '20px';
            }
        });
    </script>
<?php endif;
