<!-- 
    This template shows a SSO box on the admin backend pages
    Use this if you want to show a sso button on your backend pages
-->
<div class="actions" style="text-align:center; width:100%;">
    <div style="display:flex; flex-direction:row; flex-wrap:nowrap; align-items:center; width:100%; gap:10px; margin-bottom:10px;">
        <span style="flex:1 1 0%; height:1px; background-color:#969393;"></span>
        <span style="flex:0 0 auto; white-space:nowrap; font-weight:bold; color:#444;">OR</span>
        <span style="flex:1 1 0%; height:1px; background-color:#969393;"></span>
    </div>
    <button
        type="button"
        class="action-login action-primary"
        style="margin-top:3%; padding: 3% 14%; width:100%; text-align:center;"
        onclick="window.location.href='<?= $escaper->escapeUrl($block->getAdminSPInitiatedUrl(null, $block->getAppName())) ?>';"
    >
        <?= $escaper->escapeHtml($block->getSSOButtonText()) ?>
    </button>
</div>

<?php if ($block->isNonOidcAdminLoginDisabled()): ?>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Hide username field
            var usernameField = document.querySelector('.field-username');
            if (usernameField) {
                usernameField.style.display = 'none';
            }

            // Hide password field
            var passwordField = document.querySelector('.field-password');
            if (passwordField) {
                passwordField.style.display = 'none';
            }

            // Hide the welcome message and the <br/> after it
            var legend = document.querySelector('#login-form .admin__legend');
            if (legend) {
                legend.style.display = 'none';
                if (legend.nextSibling && legend.nextSibling.nodeName === 'BR') {
                    legend.nextSibling.style.display = 'none';
                }
            }

            // Hide standard Magento actions div and OR separator from OIDC div
            var actionsDivs = document.querySelectorAll('.form-actions .actions');
            actionsDivs.forEach(function (div) {
                var ssoButton = div.querySelector('.action-login');
                if (!ssoButton) {
                    // This is Magento's standard actions div - hide entirely
                    div.style.display = 'none';
                }
            });

            // Hide the "Forgot your password?" link
            var forgotPasswordDiv = document.querySelector('#login-form .links');
            if (forgotPasswordDiv) {
                forgotPasswordDiv.style.display = 'none';
            }

            // Ensure full-width chain so the OIDC button fills the login card
            var fieldset = document.querySelector('#login-form .admin__fieldset');
            if (fieldset) {
                fieldset.style.width = '100%';
            }
            var formActions = document.querySelector('.form-actions');
            if (formActions) {
                formActions.style.width = '100%';
                formActions.style.marginTop = '20px';
            }
        });
    </script>
<?php endif; ?>
