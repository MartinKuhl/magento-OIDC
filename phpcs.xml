<?xml version="1.0"?>
<ruleset name="MagentoOIDC">
    <description>Magento2 Standard without CSS/GraphQL sniffs</description>

    <!-- Base: Magento2 Standard -->
    <rule ref="Magento2">
        <exclude name="Magento2.Less"/>
        <exclude name="Magento2.GraphQL"/>
        <exclude name="Squiz.CSS.NamedColours"/>
        <!-- LiteralNamespaces hat einen Bug in findPrevious() der PHPCBF crasht -->
        <exclude name="Magento2.PHP.LiteralNamespaces"/>
    </rule>

    <!-- LiteralNamespaces nur als Warning melden (PHPCS zeigt es, PHPCBF fasst es nicht an) -->
    <rule ref="Magento2.PHP.LiteralNamespaces">
        <type>warning</type>
        <severity>5</severity>
    </rule>

    <!--
        Magento2 coding standard sets testVersion="8.1-8.2" internally. Our minimum PHP is 8.2
        (see composer.json), so we suppress the "NonUnionNull" sniff which flags ): null syntax
        as incompatible. The standalone null return type is valid since PHP 8.2.
    -->
    <rule ref="PHPCompatibility.FunctionDeclarations.NewReturnTypeDeclarations.NonUnionNull">
        <severity>0</severity>
    </rule>

    <!-- Only scan PHP and PHTML files -->
    <arg name="extensions" value="php,phtml"/>

    <!-- Ignore directories -->
    <exclude-pattern>vendor/*</exclude-pattern>
    <exclude-pattern>node_modules/*</exclude-pattern>
    <exclude-pattern>*/.github/*</exclude-pattern>

    <!-- Minimum supported PHP version (8.2+) -->
    <config name="testVersion" value="8.2-"/>
</ruleset>
